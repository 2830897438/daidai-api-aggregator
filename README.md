# DaiDai API Aggregator - SillyTavern æ‰©å±•

ä¸€ä¸ªç”¨äº SillyTavern çš„æ‰©å±•ï¼Œå¯ä»¥èšåˆå¤šä¸ª DaiDai API keys å¹¶æä¾›ç»Ÿä¸€çš„æœ¬åœ°ä»£ç†æœåŠ¡ï¼Œå®ç°è´Ÿè½½å‡è¡¡å’Œè‡ªåŠ¨æ•…éšœè½¬ç§»ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… **è´¦å·ç™»å½•** - ä½¿ç”¨ DaiDai å¹³å°è´¦å·å¯†ç ç™»å½•
- âœ… **è‡ªåŠ¨è·å– Keys** - è‡ªåŠ¨è·å–è´¦å·ä¸‹æ‰€æœ‰å¯ç”¨çš„ API keys
- âœ… **ä½™é¢æ˜¾ç¤º** - å®æ—¶æ˜¾ç¤ºæ€»ä½™é¢å’Œæ¯ä¸ª key çš„çŠ¶æ€
- âœ… **æœ¬åœ°ä»£ç†** - å¯åŠ¨æœ¬åœ° OpenAI æ ¼å¼çš„èšåˆä»£ç†æœåŠ¡å™¨
- âœ… **è´Ÿè½½å‡è¡¡** - è½®è¯¢ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„ API keys
- âœ… **æ•…éšœè½¬ç§»** - è‡ªåŠ¨è·³è¿‡å¤±è´¥çš„ keysï¼Œå¹¶é‡è¯•
- âœ… **æµå¼å“åº”** - å®Œæ•´æ”¯æŒ OpenAI æµå¼è¾“å‡º
- âœ… **å¥åº·æ£€æŸ¥** - å®æ—¶ç›‘æ§ä»£ç†çŠ¶æ€å’Œ keys å¯ç”¨æ€§

## å®‰è£…æ–¹æ³•

### ğŸš€ æ–¹æ³• 1: é€šè¿‡ SillyTavern æ‰©å±•ç®¡ç†å™¨å®‰è£…ï¼ˆæ¨èï¼‰

è¿™æ˜¯æœ€ç®€å•çš„å®‰è£…æ–¹æ³•ï¼Œåªéœ€å‡ æ­¥å³å¯å®Œæˆï¼š

1. **æ‰“å¼€ SillyTavern æ‰©å±•ç®¡ç†å™¨**
   - ç‚¹å‡»é¡¶éƒ¨èœå•çš„ **æ‰©å±•** å›¾æ ‡ï¼ˆğŸ§©ï¼‰
   - ç‚¹å‡» **"ä» URL å®‰è£…"** æŒ‰é’®

2. **è¾“å…¥ä»“åº“ URL**
   ```
   https://github.com/2830897438/daidai-api-aggregator
   ```

3. **ç‚¹å‡»å®‰è£…å¹¶å¯ç”¨æ‰©å±•**

4. **é…ç½®åç«¯ï¼ˆé‡è¦ï¼ï¼‰**
   - ç¼–è¾‘ `SillyTavern/server.js`ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š
   ```javascript
   // DaiDai API Aggregator Extension
   const daidaiAggregator = require('./public/scripts/extensions/third-party/daidai-api-aggregator/server.js');
   const daidaiRouter = express.Router();
   daidaiAggregator.registerEndpoints(daidaiRouter);
   app.use('/api/extensions/daidai-api-aggregator', daidaiRouter);
   ```
   - é‡å¯ SillyTavern

ğŸ“– **è¯¦ç»†æ­¥éª¤**: æŸ¥çœ‹ [SILLYTAVERN_INSTALL.md](./SILLYTAVERN_INSTALL.md)

---

### ğŸ“¦ æ–¹æ³• 2: æ‰‹åŠ¨å®‰è£…

#### 1. å¤åˆ¶æ‰©å±•æ–‡ä»¶

å°†æ•´ä¸ª `daidai` æ–‡ä»¶å¤¹å¤åˆ¶åˆ° SillyTavern çš„æ‰©å±•ç›®å½•ï¼š

```
SillyTavern/
â””â”€â”€ public/
    â””â”€â”€ scripts/
        â””â”€â”€ extensions/
            â””â”€â”€ third-party/
                â””â”€â”€ daidai-api-aggregator/    â† å°†æ‰©å±•æ”¾åœ¨è¿™é‡Œ
                    â”œâ”€â”€ manifest.json
                    â”œâ”€â”€ index.js
                    â”œâ”€â”€ style.css
                    â”œâ”€â”€ server.js
                    â””â”€â”€ README.md
```

**å®Œæ•´è·¯å¾„ç¤ºä¾‹ï¼š**
```
Windows: C:\Users\YourName\SillyTavern\public\scripts\extensions\third-party\daidai-api-aggregator\
Linux/Mac: ~/SillyTavern/public/scripts/extensions/third-party/daidai-api-aggregator/
```

### 2. æ³¨å†Œåç«¯è·¯ç”±

åœ¨ SillyTavern çš„ `server.js` æ–‡ä»¶ä¸­æ³¨å†Œæ‰©å±•çš„åç«¯è·¯ç”±ã€‚

æ‰¾åˆ° `server.js` ä¸­æ³¨å†Œæ‰©å±•çš„éƒ¨åˆ†ï¼ˆé€šå¸¸åœ¨æ–‡ä»¶æœ«å°¾ï¼‰ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

```javascript
// DaiDai API Aggregator Extension
const daidaiAggregator = require('./public/scripts/extensions/third-party/daidai-api-aggregator/server.js');
const daidaiRouter = express.Router();
daidaiAggregator.registerEndpoints(daidaiRouter);
app.use('/api/extensions/daidai-api-aggregator', daidaiRouter);
```

**æ³¨æ„ï¼š** å¦‚æœæ‰¾ä¸åˆ°åˆé€‚çš„ä½ç½®ï¼Œå¯ä»¥åœ¨ `server.js` æ–‡ä»¶ä¸­æœç´¢ `extensions` æˆ–ç±»ä¼¼çš„æ‰©å±•æ³¨å†Œä»£ç ï¼Œå¹¶åœ¨é™„è¿‘æ·»åŠ ã€‚

### 3. é‡å¯ SillyTavern

é‡å¯ SillyTavern æœåŠ¡å™¨ä»¥åŠ è½½æ‰©å±•ã€‚

### 4. å¯ç”¨æ‰©å±•

1. æ‰“å¼€ SillyTavern
2. ç‚¹å‡»é¡¶éƒ¨èœå•çš„ **"æ‰©å±•"** å›¾æ ‡ï¼ˆæ‹¼å›¾å›¾æ ‡ï¼‰
3. åœ¨æ‰©å±•åˆ—è¡¨ä¸­æ‰¾åˆ° **"DaiDai API Aggregator"**
4. å‹¾é€‰å¯ç”¨è¯¥æ‰©å±•

## ä½¿ç”¨æ–¹æ³•

### 1. ç™»å½•è´¦å·

1. åœ¨æ‰©å±•é¢æ¿ä¸­è¾“å…¥ä½ çš„ DaiDai å¹³å°è´¦å·å’Œå¯†ç 
2. ç‚¹å‡» **"ç™»å½•"** æŒ‰é’®
3. ç™»å½•æˆåŠŸåï¼Œæ‰©å±•ä¼šè‡ªåŠ¨è·å–ä½ è´¦å·ä¸‹çš„æ‰€æœ‰ API keys

### 2. æŸ¥çœ‹ä½™é¢å’Œ Keys

ç™»å½•åï¼Œä½ å¯ä»¥çœ‹åˆ°ï¼š
- **æ€»ä½™é¢** - æ‰€æœ‰ keys çš„ä½™é¢æ€»å’Œ
- **å¯†é’¥æ•°é‡** - å¯ç”¨çš„ API keys æ•°é‡
- **Keys åˆ—è¡¨** - æ¯ä¸ª key çš„è¯¦ç»†ä¿¡æ¯ï¼ˆä½™é¢ã€å·²ç”¨é¢åº¦ï¼‰

ç‚¹å‡» **"åˆ·æ–°æ•°æ®"** æŒ‰é’®å¯ä»¥æ›´æ–°æœ€æ–°çš„ä½™é¢ä¿¡æ¯ã€‚

### 3. å¯åŠ¨ä»£ç†æœåŠ¡

1. ç‚¹å‡» **"å¯åŠ¨ä»£ç†"** æŒ‰é’®
2. ä»£ç†æœåŠ¡å™¨å°†åœ¨æœ¬åœ° `http://localhost:5100/v1` å¯åŠ¨
3. ä»£ç†åœ°å€ä¼šæ˜¾ç¤ºåœ¨é¢æ¿ä¸Šï¼Œå¯ä»¥ç‚¹å‡»å¤åˆ¶æŒ‰é’®å¤åˆ¶åœ°å€

### 4. åœ¨ SillyTavern ä¸­ä½¿ç”¨ä»£ç†

1. è¿›å…¥ SillyTavern çš„ **API è®¾ç½®**
2. é€‰æ‹© **OpenAI** æˆ–å…¼å®¹çš„ API ç±»å‹
3. è®¾ç½® API URL ä¸ºï¼š`http://localhost:5100/v1`
4. API Key å¯ä»¥éšæ„å¡«å†™ï¼ˆä¼šè¢«ä»£ç†è‡ªåŠ¨æ›¿æ¢ï¼‰
5. ä¿å­˜è®¾ç½®å¹¶å¼€å§‹ä½¿ç”¨

### 5. åœæ­¢ä»£ç†

ç‚¹å‡» **"åœæ­¢ä»£ç†"** æŒ‰é’®å¯ä»¥åœæ­¢ä»£ç†æœåŠ¡å™¨ã€‚

## å·¥ä½œåŸç†

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SillyTavern   â”‚
â”‚   (å‰ç«¯)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ API è¯·æ±‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœ¬åœ°ä»£ç†æœåŠ¡å™¨  â”‚
â”‚  (localhost:5100)â”‚ â—„â”€â”€ è´Ÿè½½å‡è¡¡ + æ•…éšœè½¬ç§»
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ è½®è¯¢ä½¿ç”¨
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API Key æ±     â”‚
â”‚  â”Œâ”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”  â”‚
â”‚  â”‚K1 â”‚K2 â”‚K3 â”‚  â”‚  â† ä½ çš„å¤šä¸ª API keys
â”‚  â””â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ è½¬å‘è¯·æ±‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DaiDai API     â”‚
â”‚  (ä¸Šæ¸¸æœåŠ¡å™¨)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è´Ÿè½½å‡è¡¡ç­–ç•¥

1. **è½®è¯¢æœºåˆ¶** - æŒ‰é¡ºåºè½®æµä½¿ç”¨æ¯ä¸ª API key
2. **è‡ªåŠ¨é‡è¯•** - å¦‚æœæŸä¸ª key å¤±è´¥ï¼Œè‡ªåŠ¨å°è¯•ä¸‹ä¸€ä¸ª keyï¼ˆæœ€å¤šé‡è¯• 3 æ¬¡ï¼‰
3. **é”™è¯¯è®¡æ•°** - è·Ÿè¸ªæ¯ä¸ª key çš„é”™è¯¯æ¬¡æ•°
4. **è‡ªåŠ¨ç¦ç”¨** - è¿ç»­å¤±è´¥ 3 æ¬¡çš„ key ä¼šè¢«ä¸´æ—¶æ ‡è®°ä¸ºä¸å¯ç”¨
5. **è‡ªåŠ¨æ¢å¤** - æ‰€æœ‰ keys éƒ½ä¸å¯ç”¨æ—¶ï¼Œä¼šé‡ç½®çŠ¶æ€å¹¶é‡æ–°å°è¯•

### æ”¯æŒçš„åŠŸèƒ½

- âœ… èŠå¤©è¡¥å…¨ (Chat Completions)
- âœ… æµå¼è¾“å‡º (Streaming)
- âœ… åµŒå…¥ (Embeddings)
- âœ… æ¨¡å‹åˆ—è¡¨ (Models)
- âœ… æ‰€æœ‰ OpenAI å…¼å®¹çš„ç«¯ç‚¹

## é…ç½®é€‰é¡¹

### ä¿®æ”¹ä»£ç†ç«¯å£

å¦‚æœéœ€è¦ä¿®æ”¹ä»£ç†ç«¯å£ï¼ˆé»˜è®¤ 5100ï¼‰ï¼Œå¯ä»¥ç¼–è¾‘ `index.js` æ–‡ä»¶ï¼š

```javascript
// åœ¨æ–‡ä»¶å¼€å¤´æ‰¾åˆ°è¿™ä¸€è¡Œ
const PROXY_PORT = 5100;

// ä¿®æ”¹ä¸ºä½ æƒ³è¦çš„ç«¯å£
const PROXY_PORT = 8080;
```

### ä¿®æ”¹ä¸Šæ¸¸ API åœ°å€

å¦‚æœä½ çš„ DaiDai API åœ°å€ä¸åŒï¼Œå¯ä»¥åœ¨ `server.js` ä¸­ä¿®æ”¹ï¼š

```javascript
// åœ¨æ–‡ä»¶å¼€å¤´æ‰¾åˆ°è¿™ä¸€è¡Œ
const OPENAI_BASE_URL = 'https://api.daidaibird.top/v1';

// ä¿®æ”¹ä¸ºä½ çš„ API åœ°å€
const OPENAI_BASE_URL = 'https://your-api.example.com/v1';
```

## æ•…éšœæ’é™¤

### æ‰©å±•æ²¡æœ‰æ˜¾ç¤º

1. ç¡®è®¤æ–‡ä»¶å¤¹åç§°æ˜¯ `daidai-api-aggregator`
2. ç¡®è®¤æ‰€æœ‰æ–‡ä»¶éƒ½åœ¨æ­£ç¡®çš„ä½ç½®
3. é‡å¯ SillyTavern
4. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯æ¶ˆæ¯

### ç™»å½•å¤±è´¥

1. æ£€æŸ¥è´¦å·å’Œå¯†ç æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
3. æ£€æŸ¥ DaiDai å¹³å°æ˜¯å¦æ­£å¸¸è¿è¡Œ

### ä»£ç†å¯åŠ¨å¤±è´¥

1. ç¡®è®¤å·²æ­£ç¡®æ³¨å†Œåç«¯è·¯ç”±ï¼ˆå‚è§å®‰è£…æ­¥éª¤ 2ï¼‰
2. æ£€æŸ¥ç«¯å£ 5100 æ˜¯å¦è¢«å ç”¨
3. æŸ¥çœ‹ SillyTavern æœåŠ¡å™¨æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
4. ç¡®è®¤ `node-fetch` ä¾èµ–å·²å®‰è£…

### API è¯·æ±‚å¤±è´¥

1. ç¡®è®¤ä»£ç†æœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼ˆçŠ¶æ€æ˜¾ç¤º"è¿è¡Œä¸­"ï¼‰
2. æ£€æŸ¥æ˜¯å¦æœ‰å¯ç”¨çš„ API keys
3. ç¡®è®¤ keys æœ‰è¶³å¤Ÿçš„ä½™é¢
4. æŸ¥çœ‹ä»£ç†æœåŠ¡å™¨æ—¥å¿—äº†è§£è¯¦ç»†é”™è¯¯

### å®‰è£…ä¾èµ–

å¦‚æœé‡åˆ° `node-fetch` æœªæ‰¾åˆ°çš„é”™è¯¯ï¼Œåœ¨ SillyTavern ç›®å½•ä¸‹è¿è¡Œï¼š

```bash
npm install node-fetch
```

## å®‰å…¨å»ºè®®

- ğŸ”’ ä¸è¦åˆ†äº«ä½ çš„ç™»å½•å‡­è¯
- ğŸ”’ ä»£ç†æœåŠ¡å™¨ä»…ç»‘å®šåˆ° `127.0.0.1`ï¼ˆæœ¬åœ°å›ç¯åœ°å€ï¼‰ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®
- ğŸ”’ API keys ä»…å­˜å‚¨åœ¨æµè§ˆå™¨çš„ localStorage ä¸­
- ğŸ”’ å»ºè®®å®šæœŸæ›´æ¢å¯†ç å’Œ API keys

## æŠ€æœ¯æ ˆ

- **å‰ç«¯**: JavaScript (Vanilla), jQuery
- **åç«¯**: Node.js, Express
- **API**: RESTful, OpenAI Compatible

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-12-05)

- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- âœ… è´¦å·ç™»å½•å’Œ key è·å–
- âœ… æœ¬åœ°ä»£ç†æœåŠ¡å™¨
- âœ… è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»
- âœ… UI ç•Œé¢å’Œä½™é¢æ˜¾ç¤º

## è®¸å¯è¯

MIT License

## æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜æˆ–æœ‰åŠŸèƒ½å»ºè®®ï¼Œè¯·è”ç³»ï¼š
- **Email**: support@daidaibird.top
- **Website**: https://api.daidaibird.top

---

**äº«å—èšåˆ API keys å¸¦æ¥çš„ä¾¿åˆ©å§ï¼** ğŸ‰
